<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>コース別 距離画像</title>
  <style>
    :root{
      --bg:#F5F6F8; --card:#FFF; --border:#E3E6EA;
      --accent:#2F6FED; --text:#111; --sub:#667085; --input:#EEF3FF;
    }
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP",sans-serif;
      background:var(--bg); color:var(--text);
    }
    header{
      background:var(--accent); color:#fff;
      padding:18px 16px 14px;
      font-size:18px; font-weight:700;
    }
    .wrap{ max-width:420px; margin:0 auto; padding:14px 14px 26px; }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px;
      margin:12px 0;
      box-shadow:0 1px 0 rgba(16,24,40,.04);
    }
    .label{ font-size:12px; color:var(--sub); margin:2px 0 8px; font-weight:700; }
    select{
      width:100%;
      font-size:16px;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background:var(--input);
    }
    .hint{ font-size:12px; color:var(--sub); margin-top:8px; line-height:1.4; }
    .imgWrap{ margin-top:10px; }
    img{
      width:100%;
      height:auto;
      border-radius:12px;
      border:1px solid var(--border);
      display:none;
      background:#fff;
    }
    .status{
      font-size:13px;
      color:var(--sub);
      margin-top:8px;
      white-space:pre-wrap;
    }
    button{
      width:100%;
      padding:12px 14px;
      font-size:16px;
      font-weight:700;
      border-radius:12px;
      border:1px solid var(--border);
      background:#fff;
    }
  </style>
</head>
<body>
  <header>コース別 距離画像</header>

  <div class="wrap">
    <div class="card">
      <div class="label">コース</div>
      <select id="course">
        <option value="">選択してください</option>
        <option value="札幌">札幌</option>
        <option value="函館">函館</option>
        <option value="福島">福島</option>
        <option value="中山">中山</option>
        <option value="東京">東京</option>
        <option value="新潟">新潟</option>
        <option value="中京">中京</option>
        <option value="京都">京都</option>
        <option value="阪神">阪神</option>
        <option value="小倉">小倉</option>
      </select>
    </div>

    <div class="card">
      <div class="label">コース・距離</div>
      <select id="dist" disabled>
        <option value="">まずコースを選択してください</option>
      </select>
      <div class="hint">
        表示ルール：芝→ <b>t_距離.jpg</b> ／ ダ→ <b>d_距離.jpg</b><br>
        例：札幌 芝1000m → img/sapporo/t_1000.jpg
      </div>
    </div>

    <div class="card">
      <div class="label">結果（画像）</div>
      <div class="imgWrap">
        <img id="resultImg" alt="結果画像">
      </div>
      <div class="status" id="status">—</div>
    </div>

    <button id="clear">クリア</button>
  </div>

<script>
/* ==========
  条件2リスト（あなたの指定どおり）
========== */
const distMap = {
  "札幌": ["芝1000m","芝1200m","芝1500m","芝1800m","芝2000m","芝2600m","ダ1000m","ダ1700m","ダ2400m"],
  "函館": ["芝1000m","芝1200m","芝1800m","芝2000m","芝2600m","ダ1000m","ダ1700m","ダ2400m"],
  "福島": ["芝1000m","芝1200m","芝1800m","芝2000m","芝2600m","ダ1150m","ダ1700m","ダ2400m"],
  "中山": ["芝1200m","芝1600m","芝1800m","芝2000m","芝2200m","芝2500m","芝3600m","ダ1200m","ダ1800m","ダ2400m"],
  "東京": ["芝1400m","芝1600m","芝1800m","芝2000m","芝2300m","芝2400m","芝2500m","ダ1300m","ダ1400m","ダ1600m","ダ2100m"],
  "新潟": ["芝1000m","芝1200m","芝1400m","芝1600m","芝1800m","芝2000m","ダ1200m","ダ1800m","ダ2500m"],
  "中京": ["芝1200m","芝1400m","芝1600m","芝2000m","芝2200m","ダ1200m","ダ1400m","ダ1800m","ダ1900m"],
  "京都": ["芝1200m","芝1400m","芝1600m","芝1800m","芝2000m","芝2200m","芝2400m","芝3000m","芝3200m","ダ1200m","ダ1400m","ダ1800m","ダ1900m"],
  "阪神": ["芝1200m","芝1400m","芝1600m","芝1800m","芝2000m","芝2200m","芝2400m","芝2600m","芝3000m","ダ1200m","ダ1400m","ダ1800m","ダ2000m"],
  "小倉": ["芝1200m","芝1800m","芝2000m","芝2600m","ダ1000m","ダ1700m","ダ2400m"]
};

/* ==========
  コース名 → フォルダ名（英字）
========== */
const courseSlug = {
  "札幌":"sapporo",
  "函館":"hakodate",
  "福島":"fukushima",
  "中山":"nakayama",
  "東京":"tokyo",
  "新潟":"niigata",
  "中京":"chukyo",
  "京都":"kyoto",
  "阪神":"hanshin",
  "小倉":"kokura"
};

/* ==========
  "芝1000m" → {surface:'t', meters:'1000'}
  "ダ1150m" → {surface:'d', meters:'1150'}
========== */
function parseDistLabel(label){
  const m = label.match(/^([芝ダ])(\d+)m$/);
  if(!m) return null;
  const surface = (m[1] === "芝") ? "t" : "d";
  return { surface, meters: m[2] };
}

function buildImagePath(course, distLabel){
  const slug = courseSlug[course];
  const p = parseDistLabel(distLabel);
  if(!slug || !p) return null;
  return `img/${slug}/${p.surface}_${p.meters}.jpg`;
}

/* ==========
  UI wiring
========== */
const elCourse = document.getElementById("course");
const elDist = document.getElementById("dist");
const elImg = document.getElementById("resultImg");
const elStatus = document.getElementById("status");

function resetResult(){
  elImg.style.display = "none";
  elImg.removeAttribute("src");
  elStatus.textContent = "—";
}

function rebuildDistOptions(course){
  elDist.innerHTML = "";
  if(!course){
    elDist.disabled = true;
    const opt = document.createElement("option");
    opt.value = "";
    opt.textContent = "まずコースを選択してください";
    elDist.appendChild(opt);
    return;
  }

  elDist.disabled = false;
  const first = document.createElement("option");
  first.value = "";
  first.textContent = "選択してください";
  elDist.appendChild(first);

  (distMap[course] || []).forEach(d => {
    const opt = document.createElement("option");
    opt.value = d;
    opt.textContent = d;
    elDist.appendChild(opt);
  });
}

elCourse.addEventListener("change", () => {
  rebuildDistOptions(elCourse.value);
  elDist.value = "";
  resetResult();
});

elDist.addEventListener("change", () => {
  resetResult();
  const course = elCourse.value;
  const dist = elDist.value;
  if(!course || !dist) return;

  const path = buildImagePath(course, dist);
  if(!path){
    elStatus.textContent = "パス生成に失敗しました（表記ゆれを確認してください）";
    return;
  }

  elStatus.textContent = `読み込み中...\n${path}`;

  elImg.onload = () => {
    elImg.style.display = "block";
    elStatus.textContent = `表示中\n${path}`;
  };
  elImg.onerror = () => {
    elImg.style.display = "none";
    elStatus.textContent =
      `画像が見つかりません。\n${path}\n\n` +
      `チェック：\n` +
      `- GitHubに画像をアップ済み？\n` +
      `- フォルダ名（例 sapporo）合ってる？\n` +
      `- ファイル名（t_1000.jpg / d_1700.jpg）合ってる？\n` +
      `- 拡張子 .jpg で統一できてる？`;
  };

  // キャッシュ対策（更新しても反映されない時用）
  elImg.src = path + `?v=${Date.now()}`;
});

document.getElementById("clear").addEventListener("click", () => {
  elCourse.value = "";
  rebuildDistOptions("");
  elDist.value = "";
  resetResult();
});

// 初期化
rebuildDistOptions("");
resetResult();
</script>
</body>
</html>
